---
layout: post
title: 'ec2서버 구성'
subtitle: '230321'
categories: infra
comments: false
---

### EC2란 ?
EC2는 AWS가 제공하는 클라우드 컴퓨팅 서비스이다.

### AMI(Amazon Machine Image)란 ?
AMI는 인스턴스를 시작하는 데 필요한 정보를 제공, 인스턴스 시작 시 AMI를 지정해야 한다. 동일한 구성의 인스턴스가 여러개 필요할 때 한 AMI에서 여러 인스턴스 시작이 가능하다.

---


### ec2를 생성시 구성되는 VPC와 서브넷

<img width="576" alt="스크린샷 2023-03-21 오후 10 36 21" src="https://user-images.githubusercontent.com/64240637/226622717-c759429e-7547-42a7-b580-e9c7c224e5e7.png">

#### VPC   
- 쉽게 말해 __ec2에 접근할 수 있는 내부 망을 만드는 방법이다__   
- 좀 더 자세하게는 VPC 내에서 IP대역, 서브넷, 라우팅 테이블, 인터넷 게이트웨이, 보안 그룹, ACL등등을 생성/제어 할 수 있다


#### 서브넷   
- 하나의 네트워크가 분할되어 나눠진 작은 네트워크라고 할 수 있다. 네트워크를 분할하는 것을 서브네팅이라고 한다. 그리고 이 서브네팅은 서브넷 마스크(Subnet Mask)를 통하여 진행된다
- 서브넷을 구성하는 이유는 서비스의 규모에 맞게 분할하기 위해서 사용한다 (낭비되는 ip주소 최소화 위해)

VPC 안에서 다른 가용영역(AZ)에 같은 서브넷 대역을 사용할 수 없다. 이말은 즉슨 서브넷 A에서 10.0.0.0/24 대역을 사용했다면 서브넷 B에서 10.0.0.0/24 대역을 사용할 수 없다는 이야기이다. 그럼 /8, /16, /24, /32은 뭘 뜻하는걸까
__서브넷 마스크__ 의 개념을 알아야 하지만 간단하게 정리하면 이렇다. 10.0.0.0 각각을 옥텟이라고 표현하고 0~255까지의 값이 사용가능하다.

아래의 이미지를 보면 vpc는 10.0.0.0/16으로 설정되어 있다. 해당 vpc내에 구성되는 서브넷 ip주소는 10.0.0.0/16 --> 10.0.(0 ~ 255).(0 ~ 255): (ex - 192.168.0.0 ~ 192.168.255.255) 까지의 범위로 지정 되어진다.
<img width="418" alt="스크린샷 2023-03-21 오후 11 09 34" src="https://user-images.githubusercontent.com/64240637/226632374-604da8f7-efd4-4909-804c-8869dc4a449f.png">

---

- 10.0.0.0/8 --> 10.(0 ~ 255).(0 ~ 255).(0 ~ 255): (ex - 192.0.0.0 ~ 192.255.255.255) 까지의 범위를 표현한다
- 10.1.0.0/16 --> 10.1.(0 ~ 255).(0 ~ 255): (ex - 192.168.0.0 ~ 192.168.255.255) 까지의 범위를 표현한다
- 10.1.22.0/24 --> 10.1.22.(0 ~ 255): (ex - 192.168.82.0 ~ 192.168.82.255) 까지의 범위를 표현한다

VPC 안에서는 서브넷 구성을 할 수 있는데 이때 퍼블릭 서브넷과 프라이빗 서브넷으로 구성 할 수 있다. 외부에서 접근해야 하는 서버의 경우는 퍼블릭 서브넷에 구성되어 있다   
- 퍼블릭 서브넷: 외부와 통신이 가능한 공공 네트워크
- 프라이빗 서브넷: 외부에서 직접 접근할 수 없으며 게이트웨이를 이용해 외부로 단방향 통신(내 -> 외)만 가능한 네트워크


<br>

---

#### 보안그룹
- 인바운드 규칙과 아웃바운드 규칙을 설정하여 여러 가지 트래픽을 제어 할 수 있다 (ex - 80 = HTTP, 443 = HTTPS)